<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Lista de Canciones</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, select, button { margin: 5px; }
    .cancion { margin: 10px 0; border-bottom: 1px solid #ccc; padding: 5px; }
    .cancion button { margin-top: 5px; }
  </style>
</head>
<body>
  <h1>🎵 Lista de Canciones</h1>

  <h3>Agregar nueva canción:</h3>
  <input type="text" id="nombre" placeholder="Nombre" />
  <input type="text" id="tono" placeholder="Tono (Ej: C, Dm)" />
  <input type="number" id="bpm" placeholder="BPM" />
  <input type="text" id="clasificacion" placeholder="Clasificación (Ej: rock, balada)" />
  <input type="text" id="artista" placeholder="Artista" />
  <input type="text" id="tematica" placeholder="Temática (Ej: amor, fiesta)" />
  <button id="btnAgregar">Agregar</button>

  <h3>Filtrar canciones:</h3>
  <input type="text" id="filtroTono" placeholder="Tono" />
  <input type="number" id="filtroBpm" placeholder="BPM exacto" />
  <input type="text" id="filtroClasificacion" placeholder="Clasificación" />
  <input type="text" id="filtroArtista" placeholder="Artista" />
  <input type="text" id="filtroTematica" placeholder="Temática" />
  <button id="btnFiltrar">Filtrar</button>
  <button id="btnMostrar">Mostrar todas</button>

  <h3>🎶 Resultados:</h3>
  <div id="listaCanciones"></div>

  <script>
    let canciones = [];

    // 1) Cargar desde localStorage
    document.addEventListener('DOMContentLoaded', () => {
      const data = localStorage.getItem('canciones');
      canciones = data ? JSON.parse(data) : [];
      mostrarCanciones();
    });

    // 2) Guardar en localStorage
    function guardarStorage() {
      localStorage.setItem('canciones', JSON.stringify(canciones));
    }

    // 3) Limpiar formulario
    function limpiarFormulario() {
      ['nombre','tono','bpm','clasificacion','artista','tematica']
        .forEach(id => document.getElementById(id).value = '');
    }

    // 4) Agregar nueva canción
    document.getElementById('btnAgregar').addEventListener('click', () => {
      const nombre = document.getElementById("nombre").value.trim();
      const tono = document.getElementById("tono").value.trim();
      const bpm = parseInt(document.getElementById("bpm").value);
      const clasificacion = document.getElementById("clasificacion").value.trim();
      const artista = document.getElementById("artista").value.trim();
      const tematica = document.getElementById("tematica").value.trim();

      if (!nombre || !tono || isNaN(bpm) || !clasificacion || !artista || !tematica) {
        alert("Por favor completa todos los campos.");
        return;
      }

      canciones.push({ nombre, tono, bpm, clasificacion, artista, tematica });
      guardarStorage();
      limpiarFormulario();
      mostrarCanciones();
    });

    // 5) Mostrar lista (todas o filtradas)
    function mostrarCanciones(lista = canciones) {
      const cont = document.getElementById("listaCanciones");
      cont.innerHTML = '';
      if (lista.length === 0) {
        cont.innerHTML = '<p>No hay canciones que mostrar.</p>';
        return;
      }
      lista.forEach((c, idx) => {
        cont.innerHTML += `
          <div class="cancion">
            <strong>${c.nombre}</strong><br>
            Tono: ${c.tono} | BPM: ${c.bpm} |
            Clasificación: ${c.clasificacion} | Artista: ${c.artista} |
            Temática: ${c.tematica}
            <br>
            <button onclick="eliminarCancion(${idx})">Eliminar</button>
          </div>
        `;
      });
    }

    // 6) Eliminar con confirmación
    function eliminarCancion(index) {
      const nombre = canciones[index].nombre;
      if (confirm(`¿Estás seguro que deseas eliminar "${nombre}" de la lista?`)) {
        canciones.splice(index, 1);
        guardarStorage();
        mostrarCanciones();
      }
    }

    // 7) Filtrar según criterios
    document.getElementById('btnFiltrar').addEventListener('click', () => {
      const tono = document.getElementById("filtroTono").value.trim().toLowerCase();
      const bpm = document.getElementById("filtroBpm").value;
      const clasificacion = document.getElementById("filtroClasificacion").value.trim().toLowerCase();
      const artista = document.getElementById("filtroArtista").value.trim().toLowerCase();
      const tematica = document.getElementById("filtroTematica").value.trim().toLowerCase();

      const filtradas = canciones.filter(c => {
        return (!tono || c.tono.toLowerCase() === tono)
          && (!bpm || c.bpm == bpm)
          && (!clasificacion || c.clasificacion.toLowerCase() === clasificacion)
          && (!artista || c.artista.toLowerCase() === artista)
          && (!tematica || c.tematica.toLowerCase() === tematica);
      });

      mostrarCanciones(filtradas);
    });

    // 8) Mostrar todo
    document.getElementById('btnMostrar').addEventListener('click', () => {
      mostrarCanciones(canciones);
    });
  </script>
</body>
</html>